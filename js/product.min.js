const btnOpen = Array.from(document.querySelectorAll('.modal__open'));
const modalWrapper = Array.from(document.querySelectorAll('.modal__wrapper'));
const modalClose = Array.from(document.querySelectorAll('.modal__close'));
const scrollBlock = Array.from(document.querySelectorAll('.scroll'));

const body = document.body;
const paddingOffSet = window.innerWidth - body.offsetWidth + 'px';

const btnAccordion = document.querySelectorAll('.review__btn');
const accordion = document.querySelectorAll('.accordion');

// modal

function openModal(element) {
  element.classList.add('open');
  body.classList.add('locked');
  scrollBlock.forEach(block => {
    block.style.paddingRight = paddingOffSet;
  })
}

function closeModal(e) {
  if(e.target.classList.contains('modal__close') || e.target.closest('.modal__close') || e.target.classList.contains('modal__wrapper')) {
    e.target.closest('.modal__wrapper').classList.remove('open');
    body.classList.remove('locked');
    scrollBlock.forEach(block => {
      block.style.paddingRight = 0;
    })
  }
}

btnOpen.forEach(btn => {
  btn.addEventListener('click', (e) => {
    let data = e.target.dataset.modalOpen;

    modalWrapper.forEach(modal => {
      if(modal.dataset.modal == data) {
        openModal(modal);
      }
    })
  })
})

modalWrapper.forEach(modal => {
  modal.addEventListener("click", e => closeModal(e));
})

window.addEventListener('keydown', function(e) {
  modalWrapper.forEach(modal => {
    if(e.key === "Escape") {
      modal.classList.remove('open');
      body.classList.remove('locked');
    }
  })
})

//tab

function accordionOpen(element) {
  element.classList.add('open');
}

btnAccordion.forEach(btn => {
  btn.addEventListener('click', (e) => {
    let data = e.target.dataset.openAccordion;
    const visible = btn.getAttribute('aria-hidden');
    if(visible === 'true') {
      btn.setAttribute('aria-hidden', false);
      accordion.forEach(panel => {
        if(panel.dataset.accordion == data) {
          accordionOpen(panel);
        }
      })
    }

    if(visible === 'false') {
      btn.setAttribute('aria-hidden', true);
      accordion.forEach(panel => {
        if(panel.dataset.accordion == data) {
          panel.classList.remove('open');
        }
      })
    }
  })
})